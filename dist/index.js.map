{"version":3,"file":"index.js","sources":["../src/utils.js","../src/config_options.js","../src/events.js","../src/elements.js","../src/strftime_mapping.js","../src/index.js"],"sourcesContent":["export const kebabCase = string =>\n  string\n    .replace(/([a-z])([A-Z])/g, \"$1-$2\")\n    .replace(/[\\s_]+/g, \"-\")\n    .toLowerCase();\n\nexport const capitalize = string => {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n};\n","const booleanOptions = [\n  'allowInput',\n  'altInput',\n  'animate',\n  'clickOpens',\n  'closeOnSelect',\n  'disableMobile',\n  'enableSeconds',\n  'enableTime',\n  'inline',\n  'noCalendar',\n  'shorthandCurrentMonth',\n  'static',\n  'time_24hr',\n  'weekNumbers',\n  'wrap'\n]\n\nconst stringOptions = [\n  'altInputClass',\n  'conjunction',\n  'mode',\n  'nextArrow',\n  'position',\n  'prevArrow',\n  'monthSelectorType'\n]\n\nconst numberOptions = [\n  'defaultHour',\n  'defaultMinute',\n  'defaultSeconds',\n  'hourIncrement',\n  'minuteIncrement',\n  'showMonths'\n]\n\nconst arrayOptions = ['disable', 'enable', 'disableDaysOfWeek', 'enableDaysOfWeek']\n\nconst arrayOrStringOptions = ['defaultDate']\n\nconst dateOptions = ['maxDate', 'minDate', 'maxTime', 'minTime', 'now']\n\nexport const dateFormats = ['altFormat', 'ariaDateFormat', 'dateFormat']\n\nexport const options = {\n  string: stringOptions,\n  boolean: booleanOptions,\n  date: dateOptions,\n  array: arrayOptions,\n  number: numberOptions,\n  arrayOrString: arrayOrStringOptions\n}\n","export const events = ['change', 'open', 'close', 'monthChange', 'yearChange', 'ready', 'valueUpdate', 'dayCreate']\n","export const elements = [\n  'calendarContainer',\n  'currentYearElement',\n  'days',\n  'daysContainer',\n  'input',\n  'nextMonthNav',\n  'monthNav',\n  'prevMonthNav',\n  'rContainer',\n  'selectedDateElem',\n  'todayDateElem',\n  'weekdayContainer'\n]\n","export const mapping = {\n  '%Y': 'Y',\n  '%y': 'y',\n  '%C': 'Y',\n  '%m': 'm',\n  '%-m': 'n',\n  '%_m': 'n',\n  '%B': 'F',\n  '%^B': 'F',\n  '%b': 'M',\n  '%^b': 'M',\n  '%h': 'M',\n  '%^h': 'M',\n  '%d': 'd',\n  '%-d': 'j',\n  '%e': 'j',\n  '%H': 'H',\n  '%k': 'H',\n  '%I': 'h',\n  '%l': 'h',\n  '%-l': 'h',\n  '%P': 'K',\n  '%p': 'K',\n  '%M': 'i',\n  '%S': 'S',\n  '%A': 'l',\n  '%a': 'D',\n  '%w': 'w'\n}\n\nconst strftimeRegex = new RegExp(\n  Object.keys(mapping)\n    .join('|')\n    .replace(new RegExp('\\\\^', 'g'), '\\\\^'),\n  'g'\n)\n\nexport const convertDateFormat = (format) => {\n  return format.replace(strftimeRegex, (match) => {\n    return mapping[match]\n  })\n}\n","import { Controller } from 'stimulus'\nimport flatpickr from 'flatpickr'\nimport { kebabCase, capitalize } from './utils'\nimport { options, dateFormats } from './config_options'\nimport { events } from './events'\nimport { elements } from './elements'\nimport { convertDateFormat } from './strftime_mapping'\n\nclass StimulusFlatpickr extends Controller {\n  static targets = ['instance']\n\n  initialize() {\n    this.config = {}\n  }\n\n  connect() {\n    this._initializeEvents()\n    this._initializeOptions()\n    this._initializeDateFormats()\n\n    this.fp = flatpickr(this.flatpickrElement, {\n      ...this.config\n    })\n\n    this._initializeElements()\n  }\n\n  disconnect() {\n    const value = this.inputTarget.value\n    this.fp.destroy()\n    this.inputTarget.value = value\n  }\n\n  _initializeEvents() {\n    events.forEach((event) => {\n      if (this[event]) {\n        const hook = `on${capitalize(event)}`\n        this.config[hook] = this[event].bind(this)\n      }\n    })\n  }\n\n  _initializeOptions() {\n    Object.keys(options).forEach((optionType) => {\n      const optionsCamelCase = options[optionType]\n      optionsCamelCase.forEach((option) => {\n        const optionKebab = kebabCase(option)\n        if (this.data.has(optionKebab)) {\n          this.config[option] = this[`_${optionType}`](optionKebab)\n        }\n      })\n    })\n    this._handleDaysOfWeek()\n  }\n\n  _handleDaysOfWeek() {\n    if (this.config.disableDaysOfWeek) {\n      this.config.disableDaysOfWeek = this._validateDaysOfWeek(this.config.disableDaysOfWeek)\n      this.config.disable = [...(this.config.disable || []), this._disable.bind(this)]\n    }\n\n    if (this.config.enableDaysOfWeek) {\n      this.config.enableDaysOfWeek = this._validateDaysOfWeek(this.config.enableDaysOfWeek)\n      this.config.enable = [...(this.config.enable || []), this._enable.bind(this)]\n    }\n  }\n\n  _validateDaysOfWeek(days) {\n    if (Array.isArray(days)) {\n      return days.map((day) => parseInt(day))\n    } else {\n      console.error('days of week must be a valid array')\n      return []\n    }\n  }\n\n  _disable(date) {\n    const disabledDays = this.config.disableDaysOfWeek\n    return disabledDays.includes(date.getDay())\n  }\n\n  _enable(date) {\n    const enabledDays = this.config.enableDaysOfWeek\n    return enabledDays.includes(date.getDay())\n  }\n\n  _initializeDateFormats() {\n    dateFormats.forEach((dateFormat) => {\n      if (this.data.has(dateFormat)) {\n        this.config[dateFormat] = convertDateFormat(this.data.get(dateFormat))\n      }\n    })\n  }\n\n  _initializeElements() {\n    elements.forEach((element) => {\n      this[`${element}Target`] = this.fp[element]\n    })\n  }\n\n  _string(option) {\n    return this.data.get(option)\n  }\n\n  _date(option) {\n    return this.data.get(option)\n  }\n\n  _boolean(option) {\n    return !(this.data.get(option) == '0' || this.data.get(option) == 'false')\n  }\n\n  _array(option) {\n    return JSON.parse(this.data.get(option))\n  }\n\n  _number(option) {\n    return parseInt(this.data.get(option))\n  }\n\n  _arrayOrString(option) {\n    const val = this.data.get(option)\n    try {\n      return JSON.parse(val)\n    } catch (e) {\n      return val\n    }\n  }\n\n  get flatpickrElement() {\n    return (this.hasInstanceTarget && this.instanceTarget) || this.element\n  }\n}\n\nexport default StimulusFlatpickr\n"],"names":["kebabCase","string","replace","toLowerCase","capitalize","charAt","toUpperCase","slice","booleanOptions","stringOptions","numberOptions","arrayOptions","arrayOrStringOptions","dateOptions","dateFormats","options","boolean","date","array","number","arrayOrString","events","elements","mapping","strftimeRegex","RegExp","Object","keys","join","convertDateFormat","format","match","StimulusFlatpickr","config","_initializeEvents","_initializeOptions","_initializeDateFormats","fp","flatpickr","flatpickrElement","_initializeElements","value","inputTarget","destroy","forEach","event","hook","bind","optionType","optionsCamelCase","option","optionKebab","data","has","_handleDaysOfWeek","disableDaysOfWeek","_validateDaysOfWeek","disable","_disable","enableDaysOfWeek","enable","_enable","days","Array","isArray","map","day","parseInt","console","error","disabledDays","includes","getDay","enabledDays","dateFormat","get","element","JSON","parse","val","e","hasInstanceTarget","instanceTarget","Controller"],"mappings":"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"}